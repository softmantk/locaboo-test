generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_DB_URL")
}

model User {
  id        Int    @id @default(autoincrement())
  email     String @unique
  firstName String
  lastName  String

  assignedTasks Task[] @relation("assignee")
  reportedTasks Task[] @relation("reporter")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([firstName, lastName])
}

model Task {
  id          Int       @id @default(autoincrement())
  title       String
  description String?
  priority    Priority? @default(medium)
  status      Status?   @default(todo)

  assigneeId Int?
  reporterId Int?
  assignee   User? @relation("assignee", fields: [assigneeId], references: [id])
  reporter   User? @relation("reporter", fields: [reporterId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([status])
  @@index([priority])
  @@index([assigneeId])
  @@index([reporterId])
  @@index([createdAt])
  @@index([assigneeId, status])
}

enum Priority {
  low
  medium
  high
}

enum Status {
  todo
  inProgress
  done
  blocked
}
